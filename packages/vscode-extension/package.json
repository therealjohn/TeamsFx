{
  "name": "ms-teams-vscode-extension",
  "displayName": "Teams Toolkit",
  "description": "Create, debug, and deploy Teams apps with Teams Toolkit",
  "version": "4.0.1",
  "publisher": "TeamsDevApp",
  "author": "Microsoft Corporation",
  "icon": "media/teams.png",
  "main": "./out/src/extension.js",
  "repository": {
    "type": "git",
    "url": "https://github.com/OfficeDev/TeamsFx"
  },
  "views": {
    "teamsfx-toolkit": [
      {
        "id": "teamsfx-toolkit",
        "name": "Commands"
      }
    ]
  },
  "engines": {
    "vscode": "^1.64.0"
  },
  "license": "MIT",
  "keywords": [
    "Microsoft Teams",
    "Azure",
    "M365"
  ],
  "preview": false,
  "categories": [
    "Azure",
    "Extension Packs",
    "Snippets"
  ],
  "aiKey": "1c56be97-bb74-42cf-b04b-8f1aabf04592",
  "featureFlag": "true",
  "files": [
    "out/**/*"
  ],
  "activationEvents": [
    "onStartupFinished",
    "onCommand:fx-extension.create",
    "onCommand:fx-extension.getNewProjectPath",
    "onCommand:fx-extension.openDeploymentTreeview",
    "onCommand:fx-extension.openDocument",
    "onCommand:fx-extension.openReadMe",
    "onCommand:fx-extension.openSamples",
    "onCommand:fx-extension.openWelcome",
    "onCommand:fx-extension.selectAndDebug",
    "onCommand:fx-extension.selectTutorials",
    "onCommand:fx-extension.signinM365",
    "onCommand:fx-extension.validate-getStarted-prerequisites",
    "onCommand:workbench.action.tasks.runTask",
    "workspaceContains:**/.fx/*",
    "onView:teamsfx-empty-project"
  ],
  "contributes": {
    "icons": {
      "teamsfx-add-feature": {
        "description": "Add feature icon in command tree view",
        "default": {
          "fontPath": "./media/font/teamstoolkit.woff",
          "fontCharacter": "\\E000"
        }
      },
      "teamsfx-developer-portal": {
        "description": "Developer portal icon in command tree view",
        "default": {
          "fontPath": "./media/font/teamstoolkit.woff",
          "fontCharacter": "\\E001"
        }
      },
      "teamsfx-m365": {
        "description": "Microsoft 365 icon in account tree view",
        "default": {
          "fontPath": "./media/font/teamstoolkit.woff",
          "fontCharacter": "\\E002"
        }
      }
    },
    "viewsContainers": {
      "activitybar": [
        {
          "id": "teamsfx",
          "title": "Teams Toolkit",
          "icon": "media/teams.svg"
        }
      ]
    },
    "viewsWelcome": [
      {
        "view": "teamsfx-empty-project",
        "contents": "To start Teams app development experience, create a project or explore our samples. For more information, visit [Get Started](command:fx-extension.openWelcome?%5B%22SideBar%22%5D), [Tutorials](command:fx-extension.selectTutorials?%5B%22SideBar%22%5D) or [Documentation](command:fx-extension.openDocument?%5B%22SideBar%22%5D).\n[Create a new Teams app](command:fx-extension.create?%5B%22SideBar%22%5D)\n[View samples](command:fx-extension.openSamples?%5B%22SideBar%22%5D)\nYou can also open an existing Teams app.\n[Open folder](command:vscode.openFolder)",
        "enablement": "fx-extension.initialized"
      },
      {
        "view": "teamsfx-empty-project-and-check-upgrade",
        "contents": "To start Teams app development experience, create a project or explore our samples. For more information, visit [Get Started](command:fx-extension.openWelcome?%5B%22SideBar%22%5D), [Tutorials](command:fx-extension.selectTutorials?%5B%22SideBar%22%5D) or [Documentation](command:fx-extension.openDocument?%5B%22SideBar%22%5D).\n[Create a new Teams app](command:fx-extension.create?%5B%22SideBar%22%5D)\n[View samples](command:fx-extension.openSamples?%5B%22SideBar%22%5D)\nYou can also open an existing Teams app.\n[Open folder](command:vscode.openFolder)\nYou need to upgrade the project to the new configuration files to use the latest features. The upgrade process will not change your custom code and create the backup files in case revert is needed.\nNotice this upgrade is a must-have to continue to use current version Teams Toolkit. If you are not ready to upgrade and want to continue to use the old version Teams Toolkit, please find Teams Toolkit in Extension and install the version <=2.10.0.\n[Upgrade project](command:fx-extension.checkProjectUpgrade)",
        "enablement": "fx-extension.initialized"
      }
    ],
    "views": {
      "teamsfx": [
        {
          "id": "teamsfx-accounts",
          "name": "Accounts",
          "when": "fx-extension.isTeamsFx"
        },
        {
          "id": "teamsfx-environment",
          "name": "Environment",
          "when": "fx-extension.isTeamsFx"
        },
        {
          "id": "teamsfx-development",
          "name": "Development",
          "when": "fx-extension.isTeamsFx"
        },
        {
          "type": "webview",
          "id": "teamsfx-development-webview",
          "name": "Development",
          "when": "fx-extension.isTeamsFx && fx-extension.customizedTreeview"
        },
        {
          "id": "teamsfx-deployment",
          "name": "Deployment",
          "when": "fx-extension.isTeamsFx"
        },
        {
          "type": "webview",
          "id": "teamsfx-deployment-webview",
          "name": "Deployment",
          "when": "fx-extension.isTeamsFx && fx-extension.customizedTreeview"
        },
        {
          "id": "teamsfx-help-and-feedback",
          "name": "Help and feedback",
          "when": "fx-extension.isTeamsFx",
          "visibility": "collapsed"
        },
        {
          "id": "teamsfx-empty-project",
          "name": "Teams Toolkit",
          "when": "!fx-extension.isTeamsFx && !fx-extension.canUpgradeToArmAndMultiEnv"
        },
        {
          "id": "teamsfx-empty-project-and-check-upgrade",
          "name": "Teams Toolkit",
          "when": "!fx-extension.isTeamsFx && fx-extension.canUpgradeToArmAndMultiEnv"
        }
      ]
    },
    "menus": {
      "explorer/context": [
        {
          "command": "fx-extension.deployAadAppManifestFromCtxMenu",
          "when": "resourceFilename == aad.template.json && fx-extension.isAadManifestEnabled",
          "group": "deploy@0"
        },
        {
          "command": "fx-extension.deployManifestFromCtxMenu",
          "when": "resourceFilename =~ /^manifest.(local|remote).template.json$/ && !fx-extension.isConfigUnifyEnabled",
          "group": "deploy@0"
        },
        {
          "command": "fx-extension.deployManifestFromCtxMenu",
          "when": "resourceFilename == manifest.template.json && fx-extension.isConfigUnifyEnabled",
          "group": "deploy@0"
        }
      ],
      "view/title": [
        {
          "command": "fx-extension.addEnvironment",
          "when": "view == teamsfx-environment",
          "group": "navigation@1"
        },
        {
          "command": "fx-extension.refreshEnvironment",
          "when": "view == teamsfx-environment",
          "group": "navigation@2"
        },
        {
          "command": "fx-extension.openAccountLink",
          "when": "view == teamsfx-accounts",
          "group": "navigation@2"
        },
        {
          "command": "fx-extension.createAccount",
          "when": "view == teamsfx-accounts",
          "group": "navigation@1"
        },
        {
          "command": "fx-extension.openEnvLink",
          "when": "view == teamsfx-environment",
          "group": "navigation@3"
        },
        {
          "command": "fx-extension.openDevelopmentLink",
          "when": "view == teamsfx-development",
          "group": "navigation@1"
        },
        {
          "command": "fx-extension.openDeploymentLink",
          "when": "view == teamsfx-deployment",
          "group": "navigation@1"
        },
        {
          "command": "fx-extension.openHelpFeedbackLink",
          "when": "view == teamsfx-help-and-feedback",
          "group": "navigation@1"
        }
      ],
      "view/item/context": [
        {
          "command": "fx-extension.signOut",
          "when": "view == teamsfx-accounts && viewItem == signedinM365",
          "group": "inline@1"
        },
        {
          "command": "fx-extension.signOut",
          "when": "view == teamsfx-accounts && viewItem == signedinAzure",
          "group": "inline@1"
        },
        {
          "command": "fx-extension.m365AccountSettings",
          "when": "view == teamsfx-accounts && viewItem == signedinM365",
          "group": "inline@2"
        },
        {
          "command": "fx-extension.refreshSideloading",
          "when": "view == teamsfx-accounts && viewItem == checkSideloading",
          "group": "inline"
        },
        {
          "command": "fx-extension.azureAccountSettings",
          "when": "view == teamsfx-accounts && viewItem == signedinAzure",
          "group": "inline@2"
        },
        {
          "command": "fx-extension.specifySubscription",
          "when": "view == teamsfx-accounts && viewItem == selectSubscription",
          "group": "inline"
        },
        {
          "command": "fx-extension.openDocumentLink",
          "when": "view == teamsfx-accounts && viewItem =~ /^signinM365$|^signinAzure$/",
          "group": "inline"
        },
        {
          "command": "fx-extension.preview",
          "when": "view == teamsfx-environment && viewItem =~ /environment-provisioned|local-existing-app/"
        },
        {
          "command": "fx-extension.previewWithIcon",
          "when": "view == teamsfx-environment && viewItem =~ /environment-provisioned|local-existing-app/",
          "group": "inline@3"
        },
        {
          "command": "fx-extension.localdebug",
          "when": "view == teamsfx-environment && viewItem =~ /^local$/"
        },
        {
          "command": "fx-extension.localdebugWithIcon",
          "when": "view == teamsfx-environment && viewItem =~ /^local$/",
          "group": "inline@3"
        },
        {
          "command": "fx-extension.listCollaborator",
          "when": "view == teamsfx-environment && viewItem =~ /environment/",
          "group": "inline@3"
        },
        {
          "command": "fx-extension.openSubscriptionInPortal",
          "when": "view == teamsfx-environment && viewItem == openSubscriptionInPortal",
          "group": "inline@3"
        },
        {
          "command": "fx-extension.openResourceGroupInPortal",
          "when": "view == teamsfx-environment && viewItem == openResourceGroupInPortal",
          "group": "inline@3"
        },
        {
          "command": "fx-extension.grantPermission",
          "when": "view == teamsfx-environment && viewItem =~ /environment/",
          "group": "inline@3"
        },
        {
          "command": "fx-extension.openDocumentLink",
          "when": "view == teamsfx-development && viewItem =~ /^fx-extension.(create|openSamples|openManifest)$/",
          "group": "inline"
        },
        {
          "command": "fx-extension.openDocumentLink",
          "when": "view == teamsfx-deployment && viewItem =~ /^fx-extension.(provision|build|deploy|publish)$/",
          "group": "inline"
        }
      ],
      "editor/title/run": [
        {
          "command": "fx-extension.selectAndDebug",
          "when": "!inDebugMode && debuggersAvailable && fx-extension.runIconActive",
          "group": "teamsfx"
        }
      ],
      "editor/title": [
        {
          "command": "fx-extension.openPreviewFile",
          "when": "resourceFilename == manifest.local.template.json || resourceFilename == manifest.remote.template.json || resourceFilename == manifest.template.json",
          "group": "navigation"
        },
        {
          "command": "fx-extension.updatePreviewFile",
          "when": "resourceFilename =~ /manifest.[\\w]*.json/ && resourceDirname =~ /build/",
          "group": "navigation"
        },
        {
          "command": "fx-extension.openPreviewAadFile",
          "when": "resourceFilename == aad.template.json && fx-extension.isAadManifestEnabled",
          "group": "navigation"
        }
      ],
      "commandPalette": [
        {
          "command": "fx-extension.azureAccountSettings",
          "when": "false"
        },
        {
          "command": "fx-extension.createAccount",
          "when": "false"
        },
        {
          "command": "fx-extension.deployAadAppManifestFromCtxMenu",
          "when": "false"
        },
        {
          "command": "fx-extension.deployManifestFromCtxMenu",
          "when": "false"
        },
        {
          "command": "fx-extension.grantPermission",
          "when": "false"
        },
        {
          "command": "fx-extension.listCollaborator",
          "when": "false"
        },
        {
          "command": "fx-extension.localdebug",
          "when": "false"
        },
        {
          "command": "fx-extension.localdebugWithIcon",
          "when": "false"
        },
        {
          "command": "fx-extension.m365AccountSettings",
          "when": "false"
        },
        {
          "command": "fx-extension.openAccountLink",
          "when": "false"
        },
        {
          "command": "fx-extension.openDeploymentLink",
          "when": "false"
        },
        {
          "command": "fx-extension.openDevelopmentLink",
          "when": "false"
        },
        {
          "command": "fx-extension.openDocumentLink",
          "when": "false"
        },
        {
          "command": "fx-extension.openEnvLink",
          "when": "false"
        },
        {
          "command": "fx-extension.openHelpFeedbackLink",
          "when": "false"
        },
        {
          "command": "fx-extension.openPreviewAadFile",
          "when": "false"
        },
        {
          "command": "fx-extension.openPreviewFile",
          "when": "false"
        },
        {
          "command": "fx-extension.openResourceGroupInPortal",
          "when": "false"
        },
        {
          "command": "fx-extension.openSchema",
          "when": "false"
        },
        {
          "command": "fx-extension.openSubscriptionInPortal",
          "when": "false"
        },
        {
          "command": "fx-extension.preview",
          "when": "false"
        },
        {
          "command": "fx-extension.previewWithIcon",
          "when": "false"
        },
        {
          "command": "fx-extension.refreshEnvironment",
          "when": "false"
        },
        {
          "command": "fx-extension.refreshSideloading",
          "when": "false"
        },
        {
          "command": "fx-extension.selectAndDebug",
          "when": "false"
        },
        {
          "command": "fx-extension.signOut",
          "when": "false"
        },
        {
          "command": "fx-extension.specifySubscription",
          "when": "false"
        },
        {
          "command": "fx-extension.checkProjectUpgrade",
          "when": "fx-extension.canUpgradeToArmAndMultiEnv"
        }
      ]
    },
    "commands": [
      {
        "command": "fx-extension.create",
        "title": "%teamstoolkit.commands.createProject.title%",
        "category": "Teams"
      },
      {
        "command": "fx-extension.getNewProjectPath",
        "title": "Teams - Get Path",
        "enablement": "never"
      },
      {
        "command": "fx-extension.openDeploymentTreeview",
        "title": "Teams - Open Deployment Treeview",
        "enablement": "never"
      },
      {
        "command": "fx-extension.openDocument",
        "title": "%teamstoolkit.commands.document.title%",
        "category": "Teams"
      },
      {
        "command": "fx-extension.openReadMe",
        "title": "Teams - Open Read Me",
        "enablement": "never"
      },
      {
        "command": "fx-extension.openSamples",
        "title": "%teamstoolkit.commands.viewSamples.title%",
        "category": "Teams"
      },
      {
        "command": "fx-extension.openWelcome",
        "title": "%teamstoolkit.commands.getstarted.title%",
        "category": "Teams"
      },
      {
        "command": "fx-extension.selectAndDebug",
        "title": "%teamstoolkit.commands.debug.title%",
        "icon": "$(run)"
      },
      {
        "command": "fx-extension.selectTutorials",
        "title": "%teamstoolkit.commands.selectTutorials.title%",
        "category": "Teams"
      },
      {
        "command": "fx-extension.validate-getStarted-prerequisites",
        "title": "Teams - Validate Get Started Prerequisites",
        "enablement": "never"
      },
      {
        "command": "fx-extension.addEnvironment",
        "title": "%teamstoolkit.commands.createEnvironment.title%",
        "icon": "$(add)",
        "enablement": "fx-extension.isTeamsFx",
        "category": "Teams"
      },
      {
        "command": "fx-extension.addFeature",
        "title": "%teamstoolkit.commands.addFeature.title%",
        "enablement": "fx-extension.isTeamsFx && !fx-extension.isSPFx",
        "category": "Teams"
      },
      {
        "command": "fx-extension.build",
        "title": "%teamstoolkit.commands.zipPackage.title%",
        "enablement": "fx-extension.isTeamsFx",
        "category": "Teams"
      },
      {
        "command": "fx-extension.checkProjectUpgrade",
        "title": "%teamstoolkit.commands.upgradeProject.title%",
        "enablement": "fx-extension.initialized",
        "category": "Teams"
      },
      {
        "command": "fx-extension.cmpAccounts",
        "title": "%teamstoolkit.commands.accounts.title%",
        "category": "Teams",
        "enablement": "fx-extension.initialized"
      },
      {
        "command": "fx-extension.deploy",
        "title": "%teamstoolkit.commands.deploy.title%",
        "enablement": "fx-extension.isTeamsFx",
        "category": "Teams"
      },
      {
        "command": "fx-extension.deployAadAppManifest",
        "title": "%teamstoolkit.commands.deployAadAppManifest.title%",
        "enablement": "fx-extension.isTeamsFx && fx-extension.isAadManifestEnabled",
        "category": "Teams"
      },
      {
        "command": "fx-extension.migrateTeamsManifest",
        "title": "%teamstoolkit.commands.migrateManifest.title%",
        "enablement": "fx-extension.isTeamsFx",
        "category": "Teams"
      },
      {
        "command": "fx-extension.migrateTeamsTabApp",
        "title": "%teamstoolkit.commands.migrateApp.title%",
        "enablement": "fx-extension.isTeamsFx",
        "category": "Teams"
      },
      {
        "command": "fx-extension.openAppManagement",
        "title": "%teamstoolkit.commands.devPortal.title%",
        "enablement": "fx-extension.isTeamsFx",
        "category": "Teams"
      },
      {
        "command": "fx-extension.openManifest",
        "title": "%teamstoolkit.commands.editManifest.title%",
        "enablement": "fx-extension.isTeamsFx",
        "category": "Teams"
      },
      {
        "command": "fx-extension.openReportIssues",
        "title": "%teamstoolkit.commands.reportIssue.title%",
        "enablement": "fx-extension.isTeamsFx",
        "category": "Teams"
      },
      {
        "command": "fx-extension.provision",
        "title": "%teamstoolkit.commands.provision.title%",
        "enablement": "fx-extension.isTeamsFx",
        "category": "Teams"
      },
      {
        "command": "fx-extension.publish",
        "title": "%teamstoolkit.commands.publish.title%",
        "enablement": "fx-extension.isTeamsFx",
        "category": "Teams"
      },
      {
        "command": "fx-extension.updatePreviewFile",
        "title": "%teamstoolkit.commands.updateManifest.title%",
        "icon": "$(sync)",
        "enablement": "fx-extension.isTeamsFx",
        "category": "Teams"
      },
      {
        "command": "fx-extension.validateManifest",
        "title": "%teamstoolkit.commands.validateManifest.title%",
        "enablement": "fx-extension.isTeamsFx",
        "category": "Teams"
      },
      {
        "command": "fx-extension.azureAccountSettings",
        "title": "%teamstoolkit.commands.azureAccountSettings.title%",
        "icon": "$(settings-gear)"
      },
      {
        "command": "fx-extension.createAccount",
        "title": "%teamstoolkit.commands.createAccount.title%",
        "icon": "$(add)"
      },
      {
        "command": "fx-extension.deployAadAppManifestFromCtxMenu",
        "title": "%teamstoolkit.commands.deployAadAppManifestFromCtxMenu.title%",
        "enablement": "fx-extension.isAadManifestEnabled"
      },
      {
        "command": "fx-extension.deployManifestFromCtxMenu",
        "title": "%teamstoolkit.commands.deployManifest.ctxMenu.title%"
      },
      {
        "command": "fx-extension.grantPermission",
        "title": "%teamstoolkit.commands.addAppOwner.title%",
        "icon": "$(person-add)"
      },
      {
        "command": "fx-extension.listCollaborator",
        "title": "%teamstoolkit.commands.listAppOwner.title%",
        "icon": "$(organization)"
      },
      {
        "command": "fx-extension.localdebug",
        "title": "%teamstoolkit.commands.localDebug.title%"
      },
      {
        "command": "fx-extension.localdebugWithIcon",
        "title": "%teamstoolkit.commands.localDebug.title%",
        "icon": "$(debug-alt)"
      },
      {
        "command": "fx-extension.m365AccountSettings",
        "title": "%teamstoolkit.commands.m365AccountSettings.title%",
        "icon": "$(settings-gear)"
      },
      {
        "command": "fx-extension.openAccountLink",
        "title": "%teamstoolkit.commands.accountsLink.title%",
        "icon": "$(info)"
      },
      {
        "command": "fx-extension.openDeploymentLink",
        "title": "%teamstoolkit.commands.deploymentLink.title%",
        "icon": "$(info)"
      },
      {
        "command": "fx-extension.openDevelopmentLink",
        "title": "%teamstoolkit.commands.developmentLink.title%",
        "icon": "$(info)"
      },
      {
        "command": "fx-extension.openDocumentLink",
        "title": "%teamstoolkit.commands.openDocumentLink.title%",
        "icon": "$(info)"
      },
      {
        "command": "fx-extension.openEnvLink",
        "title": "%teamstoolkit.commands.environmentsLink.title%",
        "icon": "$(info)"
      },
      {
        "command": "fx-extension.openHelpFeedbackLink",
        "title": "%teamstoolkit.commands.feedbackLink.title%",
        "icon": "$(info)"
      },
      {
        "command": "fx-extension.openPreviewAadFile",
        "title": "%teamstoolkit.commands.previewAadManifest.title%",
        "icon": "$(file-code)"
      },
      {
        "command": "fx-extension.openPreviewFile",
        "title": "%teamstoolkit.commands.previewManifest.title%",
        "icon": "$(file-code)"
      },
      {
        "command": "fx-extension.openResourceGroupInPortal",
        "title": "%teamstoolkit.commands.openInPortal.title%",
        "icon": "$(ports-open-browser-icon)"
      },
      {
        "command": "fx-extension.openSchema",
        "title": "%teamstoolkit.commands.openManifestSchema.title%",
        "icon": "$(file-code)"
      },
      {
        "command": "fx-extension.openSubscriptionInPortal",
        "title": "%teamstoolkit.commands.openInPortal.title%",
        "icon": "$(ports-open-browser-icon)"
      },
      {
        "command": "fx-extension.preview",
        "title": "%teamstoolkit.commands.previewApp.title%"
      },
      {
        "command": "fx-extension.previewWithIcon",
        "title": "%teamstoolkit.commands.previewApp.title%",
        "icon": "$(run)"
      },
      {
        "command": "fx-extension.refreshEnvironment",
        "title": "%teamstoolkit.commands.refresh.title%",
        "icon": "$(refresh)"
      },
      {
        "command": "fx-extension.refreshSideloading",
        "title": "%teamstoolkit.commands.refresh.title%",
        "icon": "$(refresh)"
      },
      {
        "command": "fx-extension.signOut",
        "title": "%teamstoolkit.commands.signOut.title%",
        "icon": "$(sign-out)"
      },
      {
        "command": "fx-extension.specifySubscription",
        "title": "%teamstoolkit.commands.specifySubscription.title%",
        "icon": "$(list-selection)"
      }
    ],
    "taskDefinitions": [
      {
        "type": "teamsfx",
        "required": [
          "command"
        ],
        "properties": {
          "command": {
            "type": "string"
          }
        }
      }
    ],
    "problemMatchers": [
      {
        "name": "teamsfx-frontend-watch",
        "label": "TeamsFx Frontend Problems",
        "owner": "Teams Toolkit",
        "source": "teamsfx",
        "applyTo": "allDocuments",
        "fileLocation": [
          "relative",
          "${workspaceFolder}/tabs"
        ],
        "pattern": [
          {
            "regexp": "^.*?\\.js$",
            "file": 0
          },
          {
            "regexp": "^\\s*Line\\s+(\\d+):(\\d+):\\s+(.*)$",
            "line": 1,
            "column": 2,
            "message": 3
          }
        ],
        "background": {
          "activeOnStart": true,
          "beginsPattern": ".*",
          "endsPattern": "Compiled|Failed"
        },
        "severity": "error"
      },
      {
        "name": "teamsfx-backend-watch",
        "label": "TeamsFx Backend Problems",
        "owner": "Teams Toolkit",
        "source": "teamsfx",
        "applyTo": "allDocuments",
        "fileLocation": [
          "relative",
          "${workspaceFolder}/api"
        ],
        "pattern": [
          {
            "regexp": "^.*$",
            "file": 0,
            "location": 1,
            "message": 2
          }
        ],
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^.*(Job host stopped|signaling restart).*$",
          "endsPattern": "^.*(Worker process started and initialized|Host lock lease acquired by instance ID).*$"
        }
      },
      {
        "name": "teamsfx-func-hosted-bot-watch",
        "label": "TeamsFx Azure Functions Hosted Bot Problems",
        "owner": "Teams Toolkit",
        "source": "teamsfx",
        "applyTo": "allDocuments",
        "fileLocation": [
          "relative",
          "${workspaceFolder}/bot"
        ],
        "pattern": [
          {
            "regexp": "^.*$",
            "file": 0,
            "location": 1,
            "message": 2
          }
        ],
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^.*(Job host stopped|signaling restart).*$",
          "endsPattern": "^.*(Worker process started and initialized|Host lock lease acquired by instance ID).*$"
        }
      },
      {
        "name": "teamsfx-auth-watch",
        "label": "TeamsFx SimpleAuth Problems",
        "owner": "Teams Toolkit",
        "source": "teamsfx",
        "applyTo": "allDocuments",
        "fileLocation": [
          "relative",
          "${workspaceFolder}"
        ],
        "pattern": [
          {
            "regexp": "^.*$",
            "file": 0,
            "location": 1,
            "message": 2
          }
        ],
        "background": {
          "activeOnStart": true,
          "beginsPattern": ".*",
          "endsPattern": ".*"
        }
      },
      {
        "name": "teamsfx-ngrok-watch",
        "label": "TeamsFx Ngrok Problems",
        "owner": "Teams Toolkit",
        "source": "teamsfx",
        "applyTo": "allDocuments",
        "fileLocation": [
          "relative",
          "${workspaceFolder}"
        ],
        "pattern": [
          {
            "regexp": "^.*$",
            "file": 0,
            "location": 1,
            "message": 2
          }
        ],
        "background": {
          "activeOnStart": true,
          "beginsPattern": "starting web service",
          "endsPattern": "started tunnel|failed to reconnect session"
        }
      },
      {
        "name": "teamsfx-bot-watch",
        "label": "TeamsFx Bot Problems",
        "owner": "Teams Toolkit",
        "source": "teamsfx",
        "applyTo": "allDocuments",
        "fileLocation": [
          "relative",
          "${workspaceFolder}/bot"
        ],
        "pattern": [
          {
            "regexp": "^.*$",
            "file": 0,
            "location": 1,
            "message": 2
          }
        ],
        "background": {
          "activeOnStart": true,
          "beginsPattern": "[nodemon] starting",
          "endsPattern": "listening|[nodemon] app crashed"
        }
      }
    ],
    "configuration": [
      {
        "title": "Prerequisite Check",
        "order": 2,
        "properties": {
          "fx-extension.prerequisiteCheck": {
            "type": "object",
            "properties": {
              "node": {
                "type": "boolean",
                "description": "Ensure Node.js is installed."
              },
              "dotnetSdk": {
                "type": "boolean",
                "description": "Ensure .NET SDK is installed."
              },
              "funcCoreTools": {
                "type": "boolean",
                "description": "Ensure Azure Functions Core Tools is installed."
              },
              "bicep": {
                "type": "boolean",
                "description": "Ensure Bicep CLI is installed."
              },
              "ngrok": {
                "type": "boolean",
                "description": "Ensure Ngrok is installed and started."
              },
              "devCert": {
                "type": "boolean",
                "description": "Ensure development certificate is trusted."
              }
            },
            "additionalProperties": false,
            "default": {
              "node": true,
              "dotnetSdk": true,
              "funcCoreTools": true,
              "bicep": true,
              "ngrok": true,
              "devCert": true
            }
          }
        }
      },
      {
        "title": "SPFx Prerequisite Check",
        "order": 2,
        "properties": {
          "fx-extension.SPFxPrerequisiteCheck": {
            "type": "object",
            "properties": {
              "yo": {
                "type": "boolean",
                "description": "Ensure Yeoman CLI is installed. (Requires reload of VS Code)"
              },
              "sharepointYeomanGenerator": {
                "type": "boolean",
                "description": "Ensure SPFx Yeoman Generator is installed. (Requires reload of VS Code)"
              }
            },
            "additionalProperties": false,
            "default": {
              "yo": true,
              "sharepointYeomanGenerator": true
            }
          }
        }
      }
    ],
    "languages": [
      {
        "id": "teamsfx-toolkit-output",
        "mimetypes": [
          "text/x-code-output"
        ]
      }
    ],
    "grammars": [
      {
        "language": "teamsfx-toolkit-output",
        "scopeName": "teamsfx-toolkit.output",
        "path": "./syntaxes/teamsfx-toolkit-output.tmLanguage"
      }
    ],
    "walkthroughs": [
      {
        "id": "teamsToolkitGetStarted",
        "title": "Get started with Teams Toolkit",
        "description": "Jumpstart your Teams app development experience",
        "steps": [
          {
            "id": "teamsToolkitEnvironment",
            "title": "Get your environment ready",
            "description": "Teams Toolkit primarily requires NPM and Node.js. Check your environment and get ready for your first Teams app development.\n[Run prerequisite checker](command:fx-extension.validate-getStarted-prerequisites?%5B%22WalkThrough%22%5D)",
            "media": {
              "svg": "media/walkthrough/Prerequisites.svg",
              "altText": "Get your environment ready"
            }
          },
          {
            "id": "teamsToolkitBuildApp",
            "title": "Build your first Teams app",
            "description": "Choose [Teams app capabilities](https://aka.ms/teamsfx-capabilities-overview) and build your first Teams app.\nYou can create it from the scratch or explore our samples to help you quickly get started with the real-world examples and code structures.\n[Create a new Teams app](command:fx-extension.getNewProjectPath?%5B%22WalkThrough%22%5D)\n[View samples](command:fx-extension.openSamples?%5B%22WalkThrough%22%5D)",
            "media": {
              "svg": "media/walkthrough/Create.svg",
              "altText": "Build your first Teams app"
            }
          },
          {
            "id": "teamsToolkitCreateFreeAccount",
            "title": "Create a M365 testing tenant for free",
            "description": "Create a free M365 testing tenant to install and preview your Teams apps in Teams.\n If you already have an M365 organizational account, [sign in to M365](command:fx-extension.signinM365?%5B%22WalkThrough%22%5D) and validate [sideloading](https://docs.microsoft.com/en-us/microsoftteams/platform/concepts/build-and-test/prepare-your-o365-tenant#enable-custom-teams-apps-and-turn-on-custom-app-uploading) is enabled.\n[Create a M365 testing tenant](https://developer.microsoft.com/en-us/microsoft-365/dev-program)",
            "media": {
              "markdown": "media/itp/itp.md"
            }
          },
          {
            "id": "teamsToolkitPreview",
            "title": "Preview your Teams app locally",
            "description": "Press [F5](command:fx-extension.selectAndDebug?%5B%22WalkThrough%22%5D) or discover '[Run and Debug](command:workbench.view.debug)' panel on the activity bar, and click the play icon to locally preview your app in Teams context.\n[Run local preview (F5)](command:fx-extension.selectAndDebug?%5B%22WalkThrough%22%5D)\n__Tip: To run local preview, sign in to M365 (organizational account) with sideloading option.__",
            "media": {
              "svg": "media/walkthrough/F5.svg",
              "altText": "Preview your Teams app locally"
            }
          },
          {
            "id": "teamsToolkitDeploy",
            "title": "Deploy Teams apps",
            "description": "You can provision resources in the cloud and deploy your app's code to the provisioned resources. Finally, distribute your first app to Teams.\n[Open Deployment commands](command:fx-extension.openDeploymentTreeview?%5B%22WalkThrough%22%5D)\n__Tip: Learn more about ['Deployment'](https://aka.ms/teamsfx-provision).__",
            "media": {
              "svg": "media/walkthrough/Deployment.svg",
              "altText": "Deploy Teams apps"
            }
          },
          {
            "id": "teamsToolkitExploreMore",
            "title": "What's next?",
            "description": "Here are some recommendations to continue your journey with Teams Toolkit.\n • Explore [Tutorials](command:fx-extension.selectTutorials?%5B%22WalkThrough%22%5D) and get more practical guidances\n • Open [Readme.md](command:fx-extension.openReadMe?%5B%22WalkThrough%22%5D) to understand how to develop this app\n • Read our [Documentation](command:fx-extension.openDocument?%5B%22WalkThrough%22%5D)",
            "media": {
              "svg": "media/walkthrough/whatsnext.svg",
              "altText": "Tutorials, README.md and Documentation"
            }
          }
        ]
      }
    ]
  },
  "scripts": {
    "lint:staged": "lint-staged",
    "vscode:prepublish": "rimraf out && npm run package",
    "copy-files": "copyfiles -u 1 src/**/*.html src/**/*.css out/src/",
    "copy-whatisnew-files": "copyfiles WHATISNEW.md out/resource",
    "compile": "tsc -p ./ && npm run copy-files && npm run copy-whatisnew-files",
    "build": "rimraf out && webpack --mode development --config ./webpack.config.js && npm run compile",
    "build-failpoint": "rimraf out && npx ttsc -p ./",
    "watch": "webpack --watch --devtool nosources-source-map --info-verbosity verbose --config ./webpack.config.js",
    "package": "rimraf out && webpack --mode production --config ./webpack.config.js",
    "test-compile": "tsc -p ./",
    "test-watch": "tsc -watch -p ./",
    "pretest": "npm run lint && npm run check-format && npm run test-compile",
    "test:unit": "rimraf coverage && npm run compile && node out/test/unit/runTest.js && npm run test:unit:migration",
    "test:unit:migration": "nyc mocha --require ts-node/register \"test/unit/migration/*.test.ts\"",
    "test:integration": "echo 'to be implementd'",
    "test:e2e": "echo 'to be implementd'",
    "check-format": "prettier --list-different --config .prettierrc.js --ignore-path .prettierignore \"src/**/*.ts\" \"test/**/*.ts\" \"*.{js,json}\"",
    "format": "prettier --write --config .prettierrc.js --ignore-path .prettierignore \"src/**/*.ts\" \"test/**/*.ts\" \"*.{js,json}\"",
    "lint:fix": "eslint --config .eslintrc.js package.json src test --ext .ts --fix --fix-type [problem,suggestion]",
    "lint": "eslint \"src/**/*.ts\" \"test/**/*.ts\"",
    "check-sensitive": "npx eslint --plugin 'no-secrets' --cache --ignore-pattern 'package.json' --ignore-pattern 'package-lock.json'",
    "precommit": "npm run check-sensitive && lint-staged",
    "updateFont": "node ./scripts/updateFont.js",
    "previewFont": "start ./media/font/teamstoolkit.html"
  },
  "devDependencies": {
    "@azure/arm-subscriptions": "^3.0.0",
    "@azure/eslint-plugin-azure-sdk": "^2.0.1",
    "@commitlint/cli": "^14.0.1",
    "@commitlint/config-conventional": "^12.0.1",
    "@fluentui/react": "^8.5.1",
    "@istanbuljs/nyc-config-typescript": "^1.0.1",
    "@types/adm-zip": "^0.4.33",
    "@types/chai": "^4.2.14",
    "@types/chai-as-promised": "^7.1.3",
    "@types/chai-spies": "^1.0.3",
    "@types/detect-port": "^1.3.2",
    "@types/express": "^4.17.11",
    "@types/fs-extra": "^9.0.5",
    "@types/glob": "^7.1.4",
    "@types/jscodeshift": "^0.11.2",
    "@types/keytar": "^4.4.2",
    "@types/lodash": "^4.14.181",
    "@types/mocha": "^8.0.4",
    "@types/node": "^14.14.21",
    "@types/react": "^17.0.3",
    "@types/react-dom": "^17.0.2",
    "@types/react-router-dom": "^5.1.7",
    "@types/sinon": "^9.0.9",
    "@types/tmp": "^0.2.0",
    "@types/underscore": "^1.11.0",
    "@types/uuid": "^8.3.0",
    "@types/validator": "^13.1.1",
    "@types/vscode": "^1.64.0",
    "@typescript-eslint/eslint-plugin": "^5.0.0",
    "@typescript-eslint/parser": "^5.0.0",
    "@vscode/codicons": "0.0.21",
    "adm-zip": "^0.5.4",
    "chai": "^4.2.0",
    "chai-as-promised": "^7.1.1",
    "chai-spies": "^1.0.0",
    "copy-webpack-plugin": "^6.4.1",
    "copyfiles": "^2.4.1",
    "css-loader": "^5.1.3",
    "decache": "^4.6.0",
    "detect-port": "^1.3.0",
    "eslint": "^8.1.0",
    "eslint-plugin-import": "^2.25.2",
    "eslint-plugin-no-secrets": "^0.8.9",
    "eslint-plugin-prettier": "^4.0.0",
    "find-process": "^1.4.4",
    "fs-extra": "^9.0.1",
    "glob": "^7.1.7",
    "html-webpack-plugin": "^5.3.1",
    "istanbul": "^0.4.5",
    "kill-port-process": "^3.0.1",
    "lint-staged": "^11.2.6",
    "mocha": "^9.1.1",
    "mocha-junit-reporter": "^2.0.2",
    "mocha-multi-reporters": "^1.5.1",
    "mock-require": "^3.0.3",
    "ms-rest": "^2.5.4",
    "node-loader": "^2.0.0",
    "node-sass": "^7.0.1",
    "nyc": "^15.1.0",
    "prettier": "^2.4.1",
    "react": "^17.0.2",
    "react-dom": "^17.0.2",
    "react-intl": "^5.13.5",
    "react-router-dom": "^5.2.0",
    "remap-istanbul": "^0.13.0",
    "rimraf": "^3.0.2",
    "sass": "^1.32.8",
    "sass-loader": "^10.0.1",
    "sinon": "^9.2.2",
    "source-map-support": "^0.5.19",
    "style-loader": "^2.0.0",
    "terser-webpack-plugin": "^4.2.3",
    "tmp": "^0.2.1",
    "ts-loader": "^8.0.3",
    "ts-node": "^9.1.1",
    "ttypescript": "^1.5.12",
    "typescript": "^4.2.4",
    "url-loader": "^4.1.1",
    "uuid": "^8.3.2",
    "verdaccio": "^5.6.2",
    "vsce": "^2.7.0",
    "webfont": "^11.2.26",
    "webpack": "^5.38.1",
    "webpack-cli": "^4.7.2",
    "winston": "^3.3.3"
  },
  "dependencies": {
    "@azure/identity": "^1.2.1",
    "@azure/ms-rest-nodeauth": "^3.1.1",
    "@azure/msal-node": "^1.0.0-beta.5",
    "@microsoft/teamsfx-api": "^0.20.1",
    "@microsoft/teamsfx-core": "^1.11.0",
    "@npmcli/package-json": "^1.0.1",
    "@vscode/extension-telemetry": "^0.4.8",
    "@vscode/webview-ui-toolkit": "^0.9.3",
    "ajv": "^8.5.0",
    "async-mutex": "^0.3.1",
    "dotenv": "^8.2.0",
    "express": "^4.17.1",
    "jscodeshift": "^0.13.0",
    "jsonc-parser": "^3.0.0",
    "jsonschema": "^1.4.0",
    "lodash": "^4.17.21",
    "log4js": "^6.3.0",
    "open": "^8.4.0",
    "read-package-json-fast": "^2.0.3",
    "sudo-prompt": "^9.2.1",
    "underscore": "^1.12.1",
    "validator": "^13.7.0",
    "vscode-tas-client": "^0.1.47",
    "vscode-test": "^1.5.2"
  },
  "extensionDependencies": [
    "ms-vscode.azure-account"
  ],
  "gitHead": "7d60c0765c0ea8c023a26c10d1c93001c597afbb",
  "publishConfig": {
    "access": "public"
  },
  "lint-staged": {
    "*.{js,jsx,css,ts,tsx}": [
      "npx eslint --cache --fix --quiet"
    ]
  }
}
